# 测试平台接口文档

## 一、说明文档

### 1、用户鉴权

用户鉴权使用 JWT 认证， 需要认证的 Api， 需要添加请求头：

```
Authorization: Bearer Token
```

> Token 为认证（登录）成功之后， 服务器返回的 Token

### 2、数据格式规范

#### 2.1 时间序列数据格式
```json
{
  "timestamps": [1620000000, 1620000010, 1620000020],
  "values": [120, 150, 200],
  "percentiles": {
    "p50": 120,
    "p90": 180,
    "p95": 200
  }
}
```

#### 2.2 错误统计数据格式
```json
{
  "labels": ["HTTP 500", "Timeout", "Connection Error"],
  "values": [30, 20, 10]
}
```

#### 2.3 系统监控数据格式
```json
{
  "cpu": [60, 65, 70],
  "memory": [70, 75, 80],
  "network": [10, 15, 20]
}
```

### 3、状态码

## 一、说明文档

### 1、用户鉴权

用户鉴权使用 JWT 认证， 需要认证的 Api， 需要添加请求头：

```
Authorization: Bearer Token
```

> Token 为认证（登录）成功之后， 服务器返回的 Token

### 2、状态码

| 状态码 | 说明                                                         |
| ------ | ------------------------------------------------------------ |
| 200    | （成功）服务器已成功处理了请求。                             |
| 201    | （已创建）请求成功并且服务器创建了新的资源。                 |
| 204    | （无内容）服务器成功处理了请求，但没有返回任何内容。         |
| 301    | （永久移动）请求的网页已永久移动到新位置。                   |
| 302    | （临时移动）服务器目前从不同的位置响应请求。                 |
| 400    | （错误请求）服务器不理解请求的语法。                         |
| 401    | （未授权）请求要求身份验证。                                 |
| 403    | （禁止）无权限, 服务器拒绝请求。                             |
| 404    | （未找到） 服务器找不到请求的资源                            |
| 408    | （超时） 请求超时                                            |
| 422    | （验证错误） 请求参数未通过验证                              |
| 429    | （被限制）请求次数过多                                       |
| 500    | （服务器内部错误） 服务器遇到错误，无法完成请求。            |
| 501    | （尚未实施） 服务器不具备完成请求的功能。                    |
| 502    | （错误网关） 服务器作为网关或代理，从上游服务器收到无效响应。 |
| 503    | （服务不可用） 服务器目前无法使用（由于超载或停机维护）。 通常，这只是暂时状态。 |
| 504    | （网关超时） 服务器作为网关或代理，但是没有及时从上游服务器收到请求。 |
| 505    | （HTTP 版本不受支持） 服务器不支持请求中所用的 HTTP 协议版本。 |

### 3、错误信息返回

```
{'error':"错误信息"}
```

## 二、用户模块接口

#### 1、登录接口

> **接口名称：**`/api/users/login/`
>
> **请求方式：**POST
>
> **参数格式：**JSON
>
> **请求参数：**
>
> | 参数   | 变量名   | 类型   | 说明   | 是否必传 |
> | ------ | -------- | ------ | ------ | -------- |
> | 用户名 | username | 字符串 | 用户名 | 是       |
> | 密码   | password | 字符串 | 密码   | 是       |
>
> **请求示例：**
>
> - json格式参数
>
>   ```json
>   {
>     "username": "torin",
>     "password": "123456"
>   }
>   ```
>
>
> **返回示例**
>
> - 响应状态码：200
> - 响应数据：
>
> ```json
> {
>     "refresh": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ0b2tlbiI6InJlZnJlc2giLCJleHAiOjE2MTQ4NTIyODQsImp0aSI6IjkwNWEzOTdiYTQ0ODQ1OTRiZTU1MDI4NmJjNWJiZjIwIiwidXNlcl9pZCI6MX0.WktTD8vABca5nQ0c9RB-KNOsaV-E7_ziQnjezndRzkk",
>     "token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ0b2tlbiI6ImFjY2VzcyIsImV4cCI6MTYxNDc2NjE4NCwianRpIjoiZDk2MjFmZjhkMWNjNGJhODlkNTExNTQw·YjdlMTQ5ZjQiLCJ1c2VyX2lkIjoxfQ.IcCRz9kxGlwKTfCeScwGsWEjhoxPBbP6_HT3TMwBZHM"
> }
> ```

#### 2、token刷新接口

> **接口名称：**		`/api/users/token/refresh/`
>
> **请求方式：**		POST
>
> **参数格式：**		JSON
>
> **请求参数：**
>
> | 参数          | 变量名  | 类型   | 说明        | 是否必传 |
> | ------------- | ------- | ------ | ----------- | -------- |
> | refresh_token | refresh | 字符串 | 刷新token值 | 是       |
>
> **请求示例：**
>
> - json格式参数
>
>   ```json
>   {
>    "refresh": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ0b2tlbl90eXBlIjoicmVmcmVzaCIsImV4cCI6MTYzMDkzMzEwMywianRpIjoiNzc3YTg3OWYyZTM4NGExYzhlYjFhYzVhMTA5ZTU4MGQiLCJ1c2VyX2lkIjoxfQ.8duDfoZmUJBjqgyyJQqANKl5zcHpZDN8phuNoGFQBm8"
>   }
>   ```
>
> **返回示例**
>
> - 响应状态码：200
> - 响应数据：
>
> ```json
> {
>     "token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNjMwOTk1NDY3LCJqdGkiOiI2YTIwZmIwZGZmZDA0YTJiYTAwOWM0YjNjNTQ2NjZkOCIsInVzZXJfaWQiOjF9.tdCvibq2d8ts_uCbqAvCVr1JOymdbHw7HLB7QckzbUs"
> }
> ```

#### 3、校验token接口

> ##### 接口描述
>
> - 校验 jwt token是否有效
>
> ##### 请求URL
>
> - `/api/users/token/verify`
>
> ##### 请求方式
>
> - POST
>
> ##### 请求体参数
>
> | 参数名 | 必选 | 类型   | 说明          |
> | :----- | :--- | :----- | ------------- |
> | token  | 是   | string | refresh_token |
>
> ##### 返回示例
>
> - 状态码 
>
>   200 校验通过,   无响应体
>
>   401 校验失败，无效的token
>
> ```json
> {
>     "detail": "令牌无效或已过期",
>     "code": "token_not_valid"
> }
> ```



# 三、性能测试接口文档

## 1. 性能测试计划管理

### 1.1 创建性能测试计划
- 接口描述：创建新的性能测试计划
- 请求方法：POST
- URL：/api/performance/plans/
- 请求参数：
  ```json
  {
    "name": "测试计划名称",
    "description": "测试计划描述",
    "target_url": "目标测试URL",
    "test_script": "性能测试脚本内容",
    "max_users": 1000,
    "spawn_rate": 10,
    "run_time": 3600
  }
  ```
- 返回参数：
  ```json
  {
    "id": 1,
    "name": "测试计划名称",
    "description": "测试计划描述",
    "target_url": "目标测试URL",
    "test_script": "性能测试脚本内容",
    "max_users": 1000,
    "spawn_rate": 10,
    "run_time": 3600,
    "created_at": "2024-01-01 12:00:00",
    "updated_at": "2024-01-01 12:00:00"
  }
  ```

### 1.2 获取性能测试计划列表
- 接口描述：获取所有性能测试计划
- 请求方法：GET
- URL：/api/performance/plans/
- 请求参数：无
- 返回参数：
  ```json
  {
    "count": 1,
    "results": [
      {
        "id": 1,
        "name": "测试计划名称",
        "description": "测试计划描述",
        "target_url": "目标测试URL",
        "max_users": 1000,
        "spawn_rate": 10,
        "run_time": 3600,
        "created_at": "2024-01-01 12:00:00"
      }
    ]
  }
  ```

### 1.3 获取性能测试计划详情
- 接口描述：获取指定性能测试计划的详细信息
- 请求方法：GET
- URL：/api/performance/plans/{id}/
- 请求参数：无
- 返回参数：
  ```json
  {
    "id": 1,
    "name": "测试计划名称",
    "description": "测试计划描述",
    "target_url": "目标测试URL",
    "test_script": "性能测试脚本内容",
    "max_users": 1000,
    "spawn_rate": 10,
    "run_time": 3600,
    "created_at": "2024-01-01 12:00:00",
    "updated_at": "2024-01-01 12:00:00"
  }
  ```

## 2. 性能测试执行

### 2.1 启动性能测试
- 接口描述：启动指定的性能测试计划
- 请求方法：POST
- URL：/api/performance/plans/{id}/start/
- 请求参数：
  ```json
  {
    "max_users": 1000,  // 可选，覆盖计划中的设置
    "spawn_rate": 10,   // 可选，覆盖计划中的设置
    "run_time": 3600    // 可选，覆盖计划中的设置
  }
  ```
- 返回参数：
  ```json
  {
    "task_id": "abc123",
    "status": "running",
    "start_time": "2024-01-01 12:00:00"
  }
  ```

### 2.2 停止性能测试
- 接口描述：停止正在运行的性能测试
- 请求方法：POST
- URL：/api/performance/plans/{id}/stop/
- 请求参数：无
- 返回参数：
  ```json
  {
    "task_id": "abc123",
    "status": "stopped",
    "stop_time": "2024-01-01 13:00:00"
  }
  ```

### 2.3 获取测试执行状态
- 接口描述：获取性能测试的实时执行状态
- 请求方法：GET
- URL：/api/performance/tasks/{task_id}/status/
- 请求参数：无
- 返回参数：
  ```json
  {
    "task_id": "abc123",
    "status": "running",
    "current_users": 500,
    "target_users": 1000,
    "spawn_rate": 10,
    "run_time": "00:30:00",
    "stats": {
      "requests": {
        "total": 15000,
        "fails": 150,
        "success_rate": 99.0
      },
      "response_time": {
        "min": 100,
        "max": 2000,
        "avg": 500,
        "median": 450,
        "p95": 1500
      }
    }
  }
  ```

## 3. 测试结果管理

### 3.1 获取测试报告列表
- 接口描述：获取已完成的性能测试报告列表
- 请求方法：GET
- URL：/api/performance/reports/
- 请求参数：
  ```json
  {
    "plan_id": 1,      // 可选，按测试计划筛选
    "start_date": "2024-01-01",  // 可选，开始日期
    "end_date": "2024-01-31"     // 可选，结束日期
  }
  ```
- 返回参数：
  ```json
  {
    "count": 1,
    "results": [
      {
        "id": 1,
        "plan_id": 1,
        "plan_name": "测试计划名称",
        "task_id": "abc123",
        "start_time": "2024-01-01 12:00:00",
        "end_time": "2024-01-01 13:00:00",
        "status": "completed",
        "summary": {
          "total_requests": 30000,
          "success_rate": 99.5,
          "avg_response_time": 450
        }
      }
    ]
  }
  ```

### 3.2 获取测试报告详情
- 接口描述：获取指定测试报告的详细信息
- 请求方法：GET
- URL：/api/performance/reports/{id}/
- 请求参数：无
- 返回参数：
  ```json
  {
    "id": 1,
    "plan_id": 1,
    "plan_name": "测试计划名称",
    "task_id": "abc123",
    "start_time": "2024-01-01 12:00:00",
    "end_time": "2024-01-01 13:00:00",
    "duration": 3600,
    "status": "completed",
    "configuration": {
      "target_url": "目标测试URL",
      "max_users": 1000,
      "spawn_rate": 10,
      "run_time": 3600
    },
    "statistics": {
      "requests": {
        "total": 30000,
        "success": 29850,
        "fails": 150,
        "success_rate": 99.5,
        "rps": 8.33
      },
      "response_times": {
        "min": 100,
        "max": 2000,
        "avg": 450,
        "median": 400,
        "p90": 800,
        "p95": 1200,
        "p99": 1800
      },
      "errors": [
        {
          "name": "Connection timeout",
          "occurrences": 100,
          "percentage": 0.33
        }
      ]
    },
    "charts_data": {
      "response_times": [
        {"timestamp": "2024-01-01 12:00:00", "value": 400},
        {"timestamp": "2024-01-01 12:01:00", "value": 450}
      ],
      "users": [
        {"timestamp": "2024-01-01 12:00:00", "value": 100},
        {"timestamp": "2024-01-01 12:01:00", "value": 200}
      ],
      "rps": [
        {"timestamp": "2024-01-01 12:00:00", "value": 7.5},
        {"timestamp": "2024-01-01 12:01:00", "value": 8.2}
      ]
    }
  }
  ```

### 3.3 导出测试报告
- 接口描述：导出性能测试报告为PDF或HTML格式
- 请求方法：GET
- URL：/api/performance/reports/{id}/export/
- 请求参数：
  ```json
  {
    "format": "pdf"  // 可选值：pdf, html
  }
  ```
- 返回参数：文件流

## 4. WebSocket接口

### 4.1 实时数据推送
- 接口描述：通过WebSocket接收性能测试的实时数据
- WebSocket URL：ws://域名/ws/performance/{task_id}/
- 消息格式：
  ```json
  {
    "type": "stats_update",
    "data": {
      "current_users": 500,
      "rps": 8.5,
      "response_time": 450,
      "error_rate": 0.5,
      "timestamp": "2024-01-01 12:00:00"
    }
  }
  ```

## 5. 错误码说明

| 错误码 | 说明 |
|--------|------|
| 4001 | 测试计划不存在 |
| 4002 | 测试计划已在运行 |
| 4003 | 测试计划未在运行 |
| 4004 | 测试报告不存在 |
| 5001 | 性能测试执行失败 |
| 5002 | 资源不足 |
| 5003 | 网络连接失败 |

## 四、项目管理模块接口

#### 1、测试项目

##### 1、获取测试项目列表

> **接口名称：**		`/api/testPro/projects/`
>
> **请求方式：**		GET
>
> **参数格式：**		无
>
> **请求参数：**        无
>
> **返回示例**
>
> - 响应状态码：200
> - 响应数据：
>
> ```json
> [
>     {
>         "id": 1,
>         "create_time": "2022-07-12T21:59:57.606147+08:00",
>         "name": "小小电商",
>         "leader": "torin"
>     }
> ]
> ```

##### 2、创建测试项目

> **接口名称：**`/api/testPro/projects/`
>
> **请求方式：**POST
>
> **参数格式：**JSON
>
> **请求参数：**
>
> | 变量名 | 类型   | 说明       | 是否必传 |
> | ------ | ------ | ---------- | -------- |
> | name   | 字符串 | 项目名称   | 是       |
> | leader | 字符串 | 项目负责人 | 是       |
>
> **请求示例：**
>
> - json格式参数
>
> ```json
> {
>    "name": "小小电商",
>    "leader": "torin"
> }
> ```
>
> **返回示例**
>
> - 响应状态码：201
> - 响应数据：
>
> ```json
> {
>     "id": 1,
>     "create_time": "2022-07-12T21:59:57.606147+08:00",
>     "name": "小小电商接口自动化",
>     "leader": "torin"
> }
> ```

##### 3、删除测试项目

> **接口名称：**`/api/testPro/projects/${id}/`
>
> **请求方式：**DELETE
>
> **参数格式：**	路径参数
>
> - id: 项目ID
>
> **请求体参数：** 无
>
> **返回示例**
>
> - 响应状态码：204
> - 响应数据：无

##### 4、修改项目信息

> **接口名称：**`/api/testPro/projects/${id}/`
>
> **请求方式：**PATCH
>
> **参数格式：**JSON
>
> **请求体参数：**
>
> | 变量名 | 类型   | 说明       | 是否必传 |
> | ------ | ------ | ---------- | -------- |
> | name   | 字符串 | 项目名称   | 非必传   |
> | leader | 字符串 | 项目负责人 | 非必传   |
>
> **请求示例：**
>
> - json格式参数
>
> ```json
> {
>     "name": "aa",
>     "leader": "torin"
> }
> ```
>
> **返回示例**
>
> - 响应状态码：200
> - 响应数据：
>
> ```json
> {
>      "id": 1,
>      "create_time": "2022-07-12T21:59:57.606147+08:00",
>      "name": "小小电商接口自动化",
>      "leader": "torin"
> }
> ```

##### 5、获取项目详情数据

> **接口名称：**`/api/testPro/projects/${id}/`
>
> **请求方式：**GET
>
> **参数格式：**路径参数
>
> **请求参数：** 无
>
> **返回示例**
>
> - 响应状态码：200
> - 响应数据：
>
> ```json
> {
>     "id": 1,
>     "create_time": "2023-07-12T21:59:57.606147+08:00",
>     "name": "接口自动化",
>     "leader": "torin",
> }
> ```

#### 2、测试环境

##### 1、获取项目测试环境列表

> **接口名称：**`/api/testPro/envs/`
>
> **请求方式：**GET
>
> **参数格式：**查询参数(url)
>
> **请求参数：**
>
> | 变量名  | 类型 | 说明       | 是否必传 |
> | ------- | ---- | ---------- | -------- |
> | project | 整数 | 所属项目id | 否       |
>
> **请求示例：**`/api/testPro/envs/?project=1`
>
> **返回示例**
>
> - 响应状态码：200
> - 响应数据：
>
> ```json
> [
>     {
>         "id": 1,
>         "name": "本地",
>         "global_variable": {
>             "key1": "value1",
>             "key2": "value2"
>         },
>         "debug_global_variable": {},
>         "db": [],
>         "host": "http://127.0.0.1:8080",
>         "headers": {
>             "customer-header": "wahaha"
>         },
>         "global_func": "\"\"\"\n自定义全局工具函数\n============================\n\"\"\"\nfrom apitestengine.core.tools import *",
>         "project": 1
>     },
>     {
>         "id": 2,
>         "name": "ali",
>         "global_variable": {
>             "key": "Value"
>         },
>         "debug_global_variable": {},
>         "db": [
>             {
>                 "name": "db1",
>                 "type": "mysql",
>                 "config": {
>                     "user": "future",
>                     "password": "123456",
>                     "host": "api.musk.com",
>                     "port": 3306
>                 }
>             },
>             {
>                 "name": "db2",
>                 "type": "mysql",
>                 "config": {
>                     "user": "future",
>                     "password": "123456",
>                     "host": "api.musk.com",
>                     "port": 3306
>                 }
>             }
>         ],
>         "host": "http://www.hhxpython.com/",
>         "headers": {},
>         "global_func": "",
>         "project": 1
>     }
> ]
> ```

##### 2、创建测试环境

> **接口名称：**`/api/testPro/envs/`
>
> **请求方式：**POST
>
> **参数格式：**JSON
>
> **请求参数：**
>
> | 参数              | 变量名                | 类型   | 说明             | 是否必传 |
> | ----------------- | --------------------- | ------ | ---------------- | -------- |
> | 环境名称          | name                  | 字符串 | 测试环境名称     | 是       |
> | 项目主机          | host                  | 字符串 | 项目主机地址     | 是       |
> | 数据库设置        | db                    | json   | 数据库设置       | 否       |
> | 所属项目id        | project               | 整数   | 所属项目id       | 是       |
> | 请求头            | headers               | json   | 全局请求头       | 否       |
> | 全局变量          | global_variable       | json   | 环境全局变量     | 否       |
> | debug模式全局变量 | debug_global_variable | json   | 调试模式全局变量 | 否       |
> | 全局工具函数      | global_func           | 字符串 | 全局工具函数脚本 | 否       |
>
> **请求示例：**
>
> - json格式参数
>
> ```json
> {
>     "name": "ali",
>     "global_variable": {
>         "key": "Value"
>     },
>     "debug_global_variable": {},
>     "db": [
>         {
>             "name": "db1",
>             "type": "mysql",
>             "config": {
>                 "user": "future",
>                 "password": "123456",
>                 "host": "api.musk.com",
>                 "port": 3306
>             }
>         },
>         {
>             "name": "db2",
>             "type": "mysql",
>             "config": {
>                 "user": "future",
>                 "password": "123456",
>                 "host": "api.musk.com",
>                 "port": 3306
>             }
>         }
>     ],
>     "host": "http://www.hhxpython.com/",
>     "headers": {},
>     "global_func": "",
>     "project": 1
> }
> ```
>
> **返回示例**
>
> - 响应状态码：201
> - 响应数据：
>
> ```json
> {
>     "id": 2,
>     "name": "ali",
>     "global_variable": {
>         "key": "Value"
>     },
>     "debug_global_variable": {},
>     "db": [
>         {
>             "name": "db1",
>             "type": "mysql",
>             "config": {
>                 "user": "future",
>                 "password": "123456",
>                 "host": "api.musk.com",
>                 "port": 3306
>             }
>         },
>         {
>             "name": "db2",
>             "type": "mysql",
>             "config": {
>                 "user": "future",
>                 "password": "123456",
>                 "host": "api.musk.com",
>                 "port": 3306
>             }
>         }
>     ],
>     "host": "http://www.hhxpython.com/",
>     "headers": {},
>     "global_func": "",
>     "project": 1
> }
> ```



##### 3、删除测试环境

> **接口名称：**`/api/testPro/envs/${id}/`
>
> **请求方式：**DELETE
>
> **参数格式：**路径参数
>
> **请求参数：** 无
>
> **返回示例**
>
> - 响应状态码：204
> - 响应数据：无

##### 4、编辑测试环境

> **接口名称：**`/api/testPro/envs/${id}/`
>
> **请求方式：**PATCH
>
> **参数格式：**JSON
>
> **请求参数：**
>
> | 变量名                | 类型   | 说明             | 是否必传    |
> | --------------------- | ------ | ---------------- | ----------- |
> | name                  | 字符串 | 测试环境名称     | put请求必传 |
> | host                  | 字符串 | 项目主机地址     | put请求必传 |
> | db                    | json   | 数据库设置       | 否          |
> | project               | 整数   | 所属项目id       | put请求必传 |
> | headers               | json   | 全局请求头       | 否          |
> | global_variable       | json   | 环境全局变量     | 否          |
> | debug_global_variable | json   | 调试模式全局变量 | 否          |
> | global_func           | 字符串 | 全局工具函数脚本 | 否          |
>
> **请求示例：**
>
> - json格式参数
>
> ```json
> {
>     "name": "ali",
>     "global_variable": {
>         "key": "Value"
>     },
>     "debug_global_variable": {},
>     "db": [
>         {
>             "name": "db1",
>             "type": "mysql",
>             "config": {
>                 "user": "future",
>                 "password": "123456",
>                 "host": "api.musk.com",
>                 "port": 3306
>             }
>         },
>         {
>             "name": "db2",
>             "type": "mysql",
>             "config": {
>                 "user": "future",
>                 "password": "123456",
>                 "host": "api.musk.com",
>                 "port": 3306
>             }
>         }
>     ],
>     "host": "http://www.hhxpython.com/",
>     "headers": {},
>     "global_func": "",
>     "project": 1
> }
> ```
>
> **返回示例**
>
> - 响应状态码：200
> - 响应数据：
>
> ```json
> {
>     "id": 2,
>     "name": "ali",
>     "global_variable": {
>         "key": "Value"
>     },
>     "debug_global_variable": {},
>     "db": [
>         {
>             "name": "db1",
>             "type": "mysql",
>             "config": {
>                 "user": "future",
>                 "password": "123456",
>                 "host": "api.musk.com",
>                 "port": 3306
>             }
>         },
>         {
>             "name": "db2",
>             "type": "mysql",
>             "config": {
>                 "user": "future",
>                 "password": "123456",
>                 "host": "api.musk.com",
>                 "port": 3306
>             }
>         }
>     ],
>     "host": "http://www.hhxpython.com/",
>     "headers": {},
>     "global_func": "",
>     "project": 1
> }
> ```



##### 5、获取测试环境详情

> **接口名称：**`/api/testPro/envs/${id}/`
>
> **请求方式：**GET
>
> **参数格式：**路径参数
>
> **请求参数：** 无
>
> **返回示例**
>
> - 响应状态码：200
> - 响应数据：
>
> ```json
> {
>     "id": 2,
>     "name": "ali",
>     "global_variable": {
>         "key": "Value"
>     },
>     "debug_global_variable": {},
>     "db": [
>         {
>             "name": "db1",
>             "type": "mysql",
>             "config": {
>                 "user": "future",
>                 "password": "123456",
>                 "host": "api.musk.com",
>                 "port": 3306
>             }
>         },
>         {
>             "name": "db2",
>             "type": "mysql",
>             "config": {
>                 "user": "future",
>                 "password": "123456",
>                 "host": "api.musk.com",
>                 "port": 3306
>             }
>         }
>     ],
>     "host": "http://www.hhxpython.com/",
>     "headers": {},
>     "global_func": "",
>     "project": 1
> }
> ```

#### 3、测试文件

##### 1、获取测试文件列表

> **接口名称：**`/api/testPro/files/`
>
> **请求方式：**GET
>
> **参数格式：**无
>
> **请求参数：**        
>
> | 参数   | 变量名  | 类型 | 说明   | 是否必传 |
> | ------ | ------- | ---- | ------ | -------- |
> | 项目id | project | 整数 | 项目id | 否       |
>
> **返回示例**
>
> - 响应状态码：200
> - 响应数据：
>
> ```json
> [
>     {
>         "id": 7,
>         "info": [
>             "hahaha.sql",
>             "D:\\project\\backend\\upload_files\\hahaha.sql",
>             "application/octet-stream"
>         ]
>     },
>     {
>         "id": 6,
>         "info": [
>             "blue_activity.sql",
>             "D:\\project\\backend\\upload_files\\blue_activity.sql",
>             "application/octet-stream"
>         ]
>     },
>     {
>         "id": 5,
>         "info": [
>             "blue_bill.sql",
>             "D:\\project\\backend\\upload_files\\blue_bill.sql",
>             "application/octet-stream"
>         ]
>     }
> ]
> ```

##### 2、上传测试文件

> **接口名称：**`/api/testPro/files/`
>
> **请求方式：**POST
>
> **参数格式：**form表单
>
> **请求参数：**
>
> | 变量名 | 类型 | 说明     | 是否必传 |
> | ------ | ---- | -------- | -------- |
> | file   | 文件 | 上传文件 | 是       |
>
> **请求示例：**
>
> - form格式参数
>
> ```
> ------WebKitFormBoundaryuB0zvJWw5yrFtxuU
> Content-Disposition: form-data; name="file"; filename="hahaha.sql"
> Content-Type: application/octet-stream
> ------WebKitFormBoundaryuB0zvJWw5yrFtxuU--
> ```
>
> **返回示例**
>
> - 响应状态码：201
> - 响应数据：
>
> ```json
> {
>     "id":7,
>     "info":["hahaha.sql","D:\\project\\backend\\upload_files\\hahaha.sql","application/octet-stream"]
> }
> ```
>
> ##### 要求：
>
> - 上传的文件大小不能超过300kb
> - 上传的文件不能重复



##### 3、删除测试文件

> **接口名称：**`/api/testPro/file/${id}/`
>
> **请求方式：**DELETE
>
> **参数格式：**路径参数
>
> **请求参数：** 无
>
> **返回示例**
>
> - 响应状态码：204
> - 响应数据：无

## 四、接口测试模块接口

#### 1、接口管理

##### 1、添加接口

> **接口名称：**`/api/TestInterFace/interfaces/`
>
> **请求方式：**POST
>
> **参数格式：**JSON
>
> **请求参数：**
>
> | 变量名  | 类型   | 说明         | 是否必传 |
> | ------- | ------ | ------------ | -------- |
> | name    | 字符串 | 项目接口名称 | 是       |
> | url     | 字符串 | 接口地址     | 是       |
> | method  | 字符串 | 请求方法     | 是       |
> | type    | 字符串 | 接口类型     | 是       |
> | project | 整数   | 所属项目id   | 是       |
>
> **请求示例：**
>
> - json格式参数
>
> ```json
> {
>     "name": "登录",
>     "url": "/users/login/",
>     "method": "post",
>     "type": "1",
>     "project": 1
> }
> ```
>
> **返回示例**
>
> - 响应状态码：201
> - 响应数据：
>
> ```json
> {
>     "id": 1,
>     "name": "登录",
>     "url": "/users/login/",
>     "method": "post",
>     "type": "1",
>     "project": 1
> }
> ```

##### 2、获取测试接口列表

> **接口名称：**`/api/TestInterFace/interfaces/`
>
> **请求方式：**GET
>
> **参数格式：**URL参数
>
> **请求参数：**        
>
> | 变量名  | 类型 | 说明       | 是否必传 |
> | ------- | ---- | ---------- | -------- |
> | project | 整数 | 所属项目id | 否       |
>
> **返回示例**
>
> - 响应状态码：200
> - 响应数据：
>
> ```json
> [
>     {
>         "id": 1,
>         "name": "登录",
>         "url": "/users/login/",
>         "method": "post",
>         "type": "1",
>         "project": 1, 
>         "cases":[
>             {"id":1,"title":"用例名称"},
>             {"id":2,"title":"用例名称"},
>             {"id":3,"title":"用例名称"},
>             {"id":4,"title":"用例名称"},
>         ]  
>     }
> ]
> ```
>
> cases字段: 返回接口下的所有测试用例



##### 3、删除测试接口

> **接口名称：**`/api/TestInterFace/interfaces/${id}/`
>
> **请求方式：**DELETE
>
> **参数格式：**路径参数
>
> **请求参数：** 无
>
> **返回示例**
>
> - 响应状态码：204
> - 响应数据：无

##### 4、修改测试接口信息

> **接口名称：**`/api/TestInterFace/interfaces/${id}/`
>
> **请求方式：**PATCH
>
> **参数格式：**JSON
>
> **请求参数：**
>
> | 变量名  | 类型   | 说明             | 是否必传 |
> | ------- | ------ | ---------------- | -------- |
> | name    | 字符串 | 项目接口名称     | 非必传   |
> | url     | 字符串 | 接口地址         | 非必传   |
> | method  | 字符串 | 请求方法         | 非必传   |
> | type    | 字符串 | 接口类型         | 非必传   |
> | project | 整数   | 所属项目id非必传 | 非必传   |
>
> **请求示例：**
>
> - json格式参数
>
> ```json
> {
>     "name": "登录",
>     "url": "/users/login/",
>     "method": "post",
>     "type": "1",
>     "project": 1
> }
> ```
>
> **返回示例**
>
> - 响应状态码：200
> - 响应数据：
>
> ```json
> {
>     "id": 1,
>     "name": "登录",
>     "url": "/users/login/",
>     "method": "post",
>     "type": "1",
>     "project": 1
> }
> ```

#### 2、接口用例管理

##### 1、创建接口测试用例

> **接口名称：**`/api/TestInterFace/cases/`
>
> **请求方式：**POST
>
> **参数格式：**JSON
>
> **请求参数：**
>
> | 变量名          | 类型   | 说明             | 是否必传 |
> | --------------- | ------ | ---------------- | -------- |
> | title           | 字符串 | 用例名称         | 是       |
> | interface       | 整数   | 所属项目id       | 是       |
> | headers         | json   | 包含模块的id数组 | 否       |
> | request         | json   | 请求体参数       | 否       |
> | file            | json   | 上传文件参数     | 否       |
> | setup_script    | 字符串 | 前置执行脚本     | 否       |
> | teardown_script | 字符串 | 后置执行脚本     | 否       |
>
> **请求示例：**
>
> - json格式参数
>
> ```json
> {
>     "title": "登录成功",
>     "headers": {},
>     "request": {},
>     "file": [],
>     "setup_script": "# 前置脚本(python):\n# global_tools:全局工具函数\n# data:用例数据 \n# env: 局部环境\n# ENV: 全局环境\n# db: 数据库操作对象\n",
>     "teardown_script": "# 后置脚本(python):\n# global_tools:全局工具函数\n# data:用例数据 \n# response:响应对象response \n# env: 局部环境\n# ENV: 全局环境\n# db: 数据库操作对象\n",
>     "interface": 1
> }
> ```
>
> **返回示例**
>
> - 响应状态码：201
> - 响应数据：
>
> ```json
> {
>     "id": 1,
>     "title": "登录成功",
>     "headers": {},
>     "request": {},
>     "file": [],
>     "setup_script": "# 前置脚本(python):\n# global_tools:全局工具函数\n# data:用例数据 \n# env: 局部环境\n# ENV: 全局环境\n# db: 数据库操作对象\n",
>     "teardown_script": "# 后置脚本(python):\n# global_tools:全局工具函数\n# data:用例数据 \n# response:响应对象response \n# env: 局部环境\n# ENV: 全局环境\n# db: 数据库操作对象\n",
>     "interface": 1
> }
> ```

##### 2、删除接口测试用例

> **接口名称：**`/api/TestInterFace/cases/${id}/`
>
> **请求方式：**DELETE
>
> **参数格式：**路径参数
>
> **请求参数：** 无
>
> **返回示例**
>
> - 响应状态码：204
> - 响应数据：无

##### 3、编辑修改接口测试用例

> **接口名称：**`/api/TestInterFace/cases/${id}/`
>
> **请求方式：**PATCH
>
> **参数格式：**JSON
>
> **请求参数：**
>
> | 变量名          | 类型   | 说明             | 是否必传 |
> | --------------- | ------ | ---------------- | -------- |
> | title           | 字符串 | 用例名称         | 是       |
> | interface       | 整数   | 所属项目id       | 否       |
> | headers         | json   | 包含模块的id数组 | 否       |
> | request         | json   | 请求体参数       | 否       |
> | file            | json   | 上传文件参数     | 否       |
> | setup_script    | 字符串 | 前置执行脚本     | 否       |
> | teardown_script | 字符串 | 后置执行脚本     | 否       |
>
> **请求示例：**
>
> - json格式参数
>
> ```json
> {
>     "title": "登录成功",
>     "headers": {},
>     "request": {},
>     "file": [],
>     "setup_script": "# 前置脚本(python):\n# global_tools:全局工具函数\n# data:用例数据 \n# env: 局部环境\n# ENV: 全局环境\n# db: 数据库操作对象\n",
>     "teardown_script": "# 后置脚本(python):\n# global_tools:全局工具函数\n# data:用例数据 \n# response:响应对象response \n# env: 局部环境\n# ENV: 全局环境\n# db: 数据库操作对象\n",
>     "interface": 1
> }
> ```
>
> **返回示例**
>
> - 响应状态码：200
> - 响应数据：
>
> ```json
> {
>     "id": 1,
>     "title": "登录成功",
>     "headers": {},
>     "request": {},
>     "file": [],
>     "setup_script": "# 前置脚本(python):\n# global_tools:全局工具函数\n# data:用例数据 \n# env: 局部环境\n# ENV: 全局环境\n# db: 数据库操作对象\n",
>     "teardown_script": "# 后置脚本(python):\n# global_tools:全局工具函数\n# data:用例数据 \n# response:响应对象response \n# env: 局部环境\n# ENV: 全局环境\n# db: 数据库操作对象\n",
>     "interface": 1
> }
> ```

##### 4、获取接口用例列表

> **接口名称：**`/api/TestInterFace/cases/`
>
> **请求方式：**GET
>
> **参数格式：**无
>
> **请求参数：**        
>
> | 变量名    | 类型 | 说明           | 是否必传 |
> | --------- | ---- | -------------- | -------- |
> | scene     | 整数 | 测试业务流程id | 否       |
> | interface | 整数 | 接口id         | 否       |
>
> **返回示例**
>
> - 响应状态码：200
> - 响应数据：
>
> ```json
> [
>     {
>         "id": 1,
>         "title": "登录成功",
>     },
>     {
>         "id": 2,
>         "title": "登录失败",
>     },
>     {
>         "id": 3,
>         "title": "登录密码错误",
>     }
> ]
> ```

##### 5、获取接口用例详情

> **接口名称：**`/api/TestInterFace/cases/${id}/`
>
> **请求方式：**GET
>
> **参数格式：**路径参数
>
> **请求参数：**无
>
> **返回示例**
>
> - 响应状态码：200
> - 响应数据：
>
> ```json
> {
>     "id": 1,
>     "interface": {
>         "id": 1,
>         "name": "登录",
>         "url": "/users/login/",
>         "method": "POST",
>         "type": "1",
>         "project": 1
>     },
>     "title": "登录成功",
>     "headers": {},
>     "request": {},
>     "file": [],
>     "setup_script": "# 前置脚本(python):\n# global_tools:全局工具函数\n# data:用例数据 \n# env: 局部环境\n# ENV: 全局环境\n# db: 数据库操作对象\n",
>     "teardown_script": "# 后置脚本(python):\n# global_tools:全局工具函数\n# data:用例数据 \n# response:响应对象response \n# env: 局部环境\n# ENV: 全局环境\n# db: 数据库操作对象\n"
> }
> ```

##### 6、运行接口测试用例

> **接口名称：**`/api/TestInterFace/cases/run/`
>
> **请求方式：**post
>
> **参数格式：**json
>
> **请求参数：**
>
> | 变量名 | 类型 | 说明       | 是否必传 |
> | ------ | ---- | ---------- | -------- |
> | env    | int  | 测试环境id | 是       |
> | cases  | json | 测试数据   | 是       |
>
> ##### 请求示例
>
> ```json
> {
>  "env": 1,
> "cases": {
>      "title": "注册成功",
>     "interface": {
>          "url": "/api/users/register/",
>          "name": "注册接口",
>          "method": "post"
>         },
>         "headers": {
>           "content-Type": "application/json"
>       },
>       "request": {
>           "json": {
>                 "username": "${{user_mobile}}",
>                 "email": "121282@qq.com",
>                 "password": "123456qwe",
>                 "password_confirmation": "123456qwe"
>             }
>         },
>         "setup_script": "mobile = global_func.random_mobile()\r\ntest.save_global_variable('user_mobile',mobile)",
>       "teardown_script": ""
>   }
> }
> ```
>
> **返回示例**
>
> - 响应状态码：200
> - 响应数据：
>
> ```json
> {
>    "name": "注册成功",
>     "log_data": [
>         [
>             "INFO",
>             "【INFO】  |   开始执行用例：【注册成功】\n"
>         ],
>         [
>             "INFO",
>             "【INFO】  |   *********执行前置脚本*********"
>         ],
>         [
>             "INFO",
>             "【INFO】  |   ----------断言----------"
>         ],
>         [
>             "DEBUG",
>             "比较方式:相等"
>         ],
>         [
>             "DEBUG",
>             "预期结果:201"
>         ],
>         [
>             "DEBUG",
>             "实际结果:201"
>         ],
>         [
>             "INFO",
>             "【INFO】  |   断言通过!"
>         ],
>         [
>             "INFO",
>             "【INFO】  |   注册成功执行——>【通过】\n"
>         ]
>     ],
>     "url": "http://139.159.205.158:9999/api/users/register/",
>     "method": "POST",
>     "status_cede": 201,
>     "response_header": {
>         "Server": "nginx",
>         "Date": "Fri, 18 Aug 2023 09:52:02 GMT",
>         "Content-Type": "application/json",
>         "Content-Length": "65",
>         "Connection": "keep-alive",
>         "Vary": "Accept, Origin, Cookie",
>         "Allow": "POST, OPTIONS",
>         "X-Frame-Options": "DENY",
>         "X-Content-Type-Options": "nosniff",
>         "Referrer-Policy": "same-origin",
>         "Cache-Control": "no-cache"
>     },
>     "requests_header": {
>         "User-Agent": "python-requests/2.27.1",
>         "Accept-Encoding": "gzip, deflate",
>         "Accept": "*/*",
>         "Connection": "keep-alive",
>         "abs": "torin",
>         "Content-Length": "117",
>         "Content-Type": "application/json"
>     },
>     "response_body": "{\n  \"username\": \"13309649840\",\n  \"id\": 75,\n  \"email\": \"fangyang@example.net\"\n}",
>     "requests_body": "{\n  \"email\": \"fangyang@example.net\",\n  \"password\": \"qwe123\",\n  \"username\": \"13309649840\",\n  \"password_confirmation\": \"qwe123\"\n}",
>     "state": "成功",
>     "run_time": "0.455s"
> }
> ```



## 五、业务流测试模块接口

### 1、测试业务流管理

##### 1、创建测试业务流 

> **接口名称：**`/api/testFlow/scenes/`
>
> **请求方式：**POST
>
> **参数格式：**JSON
>
> **请求参数：**
>
> | 变量名  | 类型   | 说明       | 是否必传 |
> | ------- | ------ | ---------- | -------- |
> | name    | 字符串 | 业务流名称 | 是       |
> | project | 整数   | 所属项目id | 是       |
>
> **请求示例：**
>
> - json格式参数
>
> ```json
> {
>    "name": "登录接口测试",
>    "project": 1,
> }
> ```
>
> **返回示例**
>
> - 响应状态码：201
> - 响应数据：
>
> ```json
> {
>     "id": 1,
>     "name": "登录接口测试",
>     "project": 1
> }
> ```

##### 2、删除测试业务流

> **接口名称：**`/api/testFlow/scenes/${id}/`
>
> **请求方式：**DELETE
>
> **参数格式：**路径参数
>
> **请求参数：** 无
>
> **返回示例**
>
> - 响应状态码：204
> - 响应数据：无

##### 3、修改测试业务流

> **接口名称：**`/api/testFlow/scenes/${id}/`
>
> **请求方式：**PATCH
>
> **参数格式：**JSON
>
> **请求参数：**
>
> | 变量名 | 类型   | 说明       | 是否必传 |
> | ------ | ------ | ---------- | -------- |
> | name   | 字符串 | 业务流名称 | 是       |
>
> **请求示例：**
>
> - json格式参数
>
> ```json
> {
>    "name": "注册接口测试",
> }
> ```
>
> **返回示例**
>
> - 响应状态码：200
> - 响应数据：
>
> ```json
> {
>     "id": 1,
>     "name": "登录接口测试",
>     "project": 1
> }
> ```

##### 4、获取测试业务流列表

> **接口名称：**``/api/testFlow/scenes/``
>
> **请求方式：**GET
>
> **参数格式：**无
>
> **请求参数：**        
>
> | 变量名  | 类型 | 说明       | 是否必传 |
> | ------- | ---- | ---------- | -------- |
> | project | 整数 | 项目id     | 是       |
> | task    | 整数 | 测试任务id | 否       |
>
> **返回示例**
>
> - 响应状态码：200
> - 响应数据：
>
> ```json
> [
>     {
>         "id": 1,
>         "name": "登录接口测试",
>         "project": 1
>     },
>     {
>         "id": 2,
>         "name": "注册接口测试",
>         "project": 1
>     }
> ]
> ```

##### 5、运行测试业务流程

> **接口名称：**`/api/testFlow/scenes/run/`
>
> **请求方式：**post
>
> **参数格式：**json
>
> **请求参数：**
>
> | 变量名 | 类型 | 说明               | 是否必传 |
> | ------ | ---- | ------------------ | -------- |
> | env    | int  | 测试环境id         | 是       |
> | scene  | int  | 运行的测试业务流id | 是       |
>
> ##### 请求示例
>
> ```json
> {
> "env": 2,
> "scene": 1
> }
> ```
>
> ###### 响应示例
>
> ```json
> {
> "all": 2,
> "success": 2,
> "fail": 0,
> "error": 0,
> "cases": [
>   {
>       "name": "注册成功",
>       "log_data": [],
>       "url": "http://139.159.205.158:9999/api/users/token/refresh/",
>       "method": "POST",
>       "status_cede": 200,
>       "response_header": {
>           "Server": "nginx",
>           "Date": "Fri, 18 Aug 2023 10:18:59 GMT",
>           "Content-Type": "application/json",
>           "Content-Length": "242",
>           "Connection": "keep-alive",
>           "Vary": "Accept, Origin",
>           "Allow": "POST, OPTIONS",
>           "X-Frame-Options": "DENY",
>           "X-Content-Type-Options": "nosniff",
>           "Referrer-Policy": "same-origin",
>           "Cache-Control": "no-cache"
>       },
>       "requests_header": {
>           "User-Agent": "python-requests/2.27.1",
>           "Accept-Encoding": "gzip, deflate",
>           "Accept": "*/*",
>           "Connection": "keep-alive",
>           "Content-Length": "246",
>           "Content-Type": "application/json"
>       },
>       "response_body": "{\n  \"access\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNjkyNDQwMzM5LCJpYXQiOjE2OTIyNzcwNjIsImp0aSI6ImJiYjhiMmVmNWY4MzRlNTFiNGVjZTJhNDhiN2NlOTEyIiwidXNlcl9pZCI6NzR9.WQ1mfT2P8eoRGXMFfedqFS_Bnu2PZvN4YrSoEddQ1lE\"\n}",
>       "requests_body": "{\n  \"refresh\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoicmVmcmVzaCIsImV4cCI6MTY5Mjg4MTg2MiwiaWF0IjoxNjkyMjc3MDYyLCJqdGkiOiI3MDU4YTBjZjY2YzE0MjAwYjFmODg3OTE3ZDQwNzM1MCIsInVzZXJfaWQiOjc0fQ.6ZJ6ZBpNdRPu8Z3jee8bxjzudo6_NfNNI6BuZmkR72A\"\n}",
>       "state": "成功",
>       "run_time": "0.0304s"
>   }
> ],
> "state": "success",
> "name": "注册登录"
> }
> ```



### 2、业务流中的用例管理

##### 1、往测试业务流中添加执行步骤

> **接口名称：**`/api/testFlow/icases/`
>
> **请求方式：**POST
>
> **参数格式：**JSON
>
> **请求参数：**
>
> | 变量名  | 类型 | 说明         | 是否必传 |
> | :------ | ---- | :----------- | -------- |
> | `icase` | 整数 | 接口用例id   | 是       |
> | `scene` | 整数 | 测试业务流id | 是       |
> | `sort`  | 整数 | 执行顺序     | 是       |
>
> **请求示例：**
>
> - json格式参数
>
> ```json
> {
>     "sort": 2,
>     "icase": 1,
>     "scene": 1
> }
> ```
>
> **返回示例**
>
> - 响应状态码：201
> - 响应数据：
>
> ```json
> {
>     "id": 1,
>     "sort": 2,
>     "icace": 1,
>     "scene": 1
> },
> ```

##### 2、删除测试业务流中执行步骤

> **接口名称：**`/api/testFlow/icases/${id}/`
>
> **请求方式：**DELETE
>
> **参数格式：**路径参数
>
> **请求参数：** 无
>
> **返回示例**
>
> - 响应状态码：204
> - 响应数据：无

##### 3、修改测试业务流中执行步骤的顺序

> **接口名称：**`/api/testFlow/icases/order/`
>
> **请求方式：**PATCH
>
> **参数格式：**JSON
>
> **请求参数：**
>
> **请求示例：**
>
> - json格式参数
>
> ```json
> [{"id":1,"sort":1},
>  {"id":2,"sort":2},
>  {"id":3,"sort":3},
>  {"id":4,"sort":4}]
> ```
>
> **返回示例**
>
> - 响应状态码：200
> - 响应数据：

##### 4、获取测试业务流中所有的执行步骤

> **接口名称：**`/api/testFlow/icases/`
>
> **请求方式：**GET
>
> **参数格式：**url参数
>
> **请求参数：**        
>
> | 变量名 | 类型 | 说明     | 是否必传 |
> | ------ | ---- | -------- | -------- |
> | scene  | 整数 | 业务流ID | 是       |
>
> **返回示例**
>
> - 响应状态码：200
> - 响应数据：
>
> ```json
> [
>     {
>         "id": 1,
>         "sort": 2,
>         "icase": {
>             "id": 2,
>             "title": "登录失败"
>         },
>         "scene": 1
>     },
>     {
>         "id": 2,
>         "icase": {
>             "id": 2,
>             "title": "登录失败"
>         },
>         "sort": 1,
>         "scene": 1
>     }
> ]
> ```



## 六、测试任务模块接口

#### 1、测试任务管理

##### 1、创建测试任务

> **接口名称：**`/api/testTask/tasks/`
>
> **请求方式：**POST
>
> **参数格式：**JSON
>
> **请求参数：**
>
> | 变量名    | 类型   | 说明           | 是否必传 |
> | :-------- | ------ | :------------- | -------- |
> | `name`    | 字符串 | 测试计划名称   | 是       |
> | `project` | 整数   | 项目id         | 是       |
> | `scene`   | json   | 包含的测试场景 | 否       |
>
> **请求示例：**
>
> - json格式参数
>
> ```json
> {
>     "name": "回归测试",
>     "project": 1,
>     "scene": [
>         1,
>         2
>     ]
> }
> ```
>
> **返回示例**
>
> - 响应状态码：201
> - 响应数据：
>
> ```json
> {
>     "id": 1,
>     "name": "回归测试",
>     "project": 1,
>     "scenes": [
>         1,
>         2
>     ]
> }
> ```

##### 2、修改测试任务

> **接口名称：**`/api/testTask/tasks/${id}/`
>
> **请求方式：**PATCH
>
> **参数格式：**JSON
>
> **请求参数：**
>
> | 变量名   | 类型   | 说明           | 是否必传 |
> | -------- | ------ | -------------- | -------- |
> | `name`   | 字符串 | 测试计划名称   | 否       |
> | `scenes` | json   | 包含的测试场景 | 否       |
>
> **请求示例：**
>
> - json格式参数
>
> ```json
> {
>     "name": "回归测试",
>     "project": 1,
>     "scenes": [
>         1,
>         2
>     ]
> }
> ```
>
> **返回示例**
>
> - 响应状态码：200
> - 响应数据：
>
> ```json
> {
>     "id": 1,
>     "name": "回归测试",
>     "project": 1,
>     "scenes": [
>         1,
>         2
>     ]
> }
> ```

##### 3、删除测试任务

>**接口名称：**`/api/testTask/tasks/${id}/`
>
>**请求方式：**DELETE
>
>**参数格式：**路径参数
>
>**请求参数：** 无
>
>**返回示例**
>
>- 响应状态码：204
>- 响应数据：无

##### 4、获取测试任务列表

> **接口名称：**`/api/testTask/tasks/`
>
> **请求方式：**GET
>
> **参数格式：**url参数
>
> **请求参数：**        
>
> | 变量名  | 类型 | 说明   | 是否必传 |
> | ------- | ---- | ------ | -------- |
> | project | 整数 | 项目id | 是       |
>
> **返回示例**
>
> - 响应状态码：200
> - 响应数据：
>
> ```json
> [
>     {
>         "id": 1,
>         "name": "回归测试",
>         "project": 1,
>     },
>      {
>         "id": 2,
>         "name": "冒烟测试",
>         "project": 3,
>     }
> ]
> ```

##### 5、获取测试任务详情

> **口名称：**`/api/testTask/tasks/${id}/`
>
> **请求方式：**GET
>
> **参数格式：**路径参数
>
> **请求参数：**无
>
> **返回示例**
>
> - 响应状态码：200
> - 响应数据：
>
> ```json
> {
>     "id": 1,
>     "scene": [
>         {
>             "id": 1,
>             "name": "登录测试999",
>             "project": 1
>         },
>         {
>             "id": 3,
>             "name": "演示创建的业务流",
>             "project": 1
>         }
>     ],
>     "name": "冒烟测试",
>     "project": 1
> }
> ```

##### 6、运行测试任务

> **接口名称：**`/api/testTask/tasks/run/`
>
> **请求方式：**post
>
> **参数格式：**json
>
> **请求参数：**
>
> | 变量名 | 类型 | 说明         | 是否必传 |
> | ------ | ---- | ------------ | -------- |
> | env    | int  | 测试环境id   | 是       |
> | task   | int  | 运行的任务id | 是       |
>
> ##### 请求示例
>
> ```json
> {
> "env": 2,
> "task": 1
> }
> ```
>
> ###### 响应示例
>
> ```json
> {
> "all": 2,
> "success": 2,
> "fail": 0,
> "error": 0,
> "cases": [
>   {
>       "name": "注册成功",
>       "log_data": [],
>       "url": "http://139.159.205.158:9999/api/users/token/refresh/",
>       "method": "POST",
>       "status_cede": 200,
>       "response_header": {
>           "Server": "nginx",
>           "Date": "Fri, 18 Aug 2023 10:18:59 GMT",
>           "Content-Type": "application/json",
>           "Content-Length": "242",
>           "Connection": "keep-alive",
>           "Vary": "Accept, Origin",
>           "Allow": "POST, OPTIONS",
>           "X-Frame-Options": "DENY",
>           "X-Content-Type-Options": "nosniff",
>           "Referrer-Policy": "same-origin",
>           "Cache-Control": "no-cache"
>       },
>       "requests_header": {
>           "User-Agent": "python-requests/2.27.1",
>           "Accept-Encoding": "gzip, deflate",
>           "Accept": "*/*",
>           "Connection": "keep-alive",
>           "Content-Length": "246",
>           "Content-Type": "application/json"
>       },
>       "response_body": "{\n  \"access\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoiYWNjZXNzIiwiZXhwIjoxNjkyNDQwMzM5LCJpYXQiOjE2OTIyNzcwNjIsImp0aSI6ImJiYjhiMmVmNWY4MzRlNTFiNGVjZTJhNDhiN2NlOTEyIiwidXNlcl9pZCI6NzR9.WQ1mfT2P8eoRGXMFfedqFS_Bnu2PZvN4YrSoEddQ1lE\"\n}",
>       "requests_body": "{\n  \"refresh\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ0b2tlbl90eXBlIjoicmVmcmVzaCIsImV4cCI6MTY5Mjg4MTg2MiwiaWF0IjoxNjkyMjc3MDYyLCJqdGkiOiI3MDU4YTBjZjY2YzE0MjAwYjFmODg3OTE3ZDQwNzM1MCIsInVzZXJfaWQiOjc0fQ.6ZJ6ZBpNdRPu8Z3jee8bxjzudo6_NfNNI6BuZmkR72A\"\n}",
>       "state": "成功",
>       "run_time": "0.0304s"
>   }
> ],
> "state": "success",
> "name": "注册登录"
> }
> ```



#### 2、测试运行记录和报告

##### 1、获取任务运行记录

> **接口名称：**`/api/testTask/records/`
>
> **请求方式：**GET
>
> **参数格式：**查询参数
>
> | 变量名  | 类型 | 说明         | 是否必传 |
> | ------- | ---- | ------------ | -------- |
> | project | 整数 | 项目id       | 否       |
> | task    | 整数 | 测试计划的id | 否       |
>
> **返回示例**
>
> - 响应状态码：200
> - 响应数据：
>
> ```json
> [
>  {
>      "id": 1,
>      "env": "本地",
>      "task": "回归测试",
>      "all": 2,
>      "success": 2,
>      "fail": 0,
>      "error": 0,
>      "pass_rate": "100.00",
>      "tester": "",
>      "status": "执行完毕",
>  }
> ]
> ```

##### 2、获取测试报告详情

> **接口名称：**`/api/testTask/report/${id}/`
>
> **请求方式：**GET
>
> **参数格式：**路径参数 id  (此id为测试运行记录的id,不是测报告的id)    
>
> **返回示例**
>
> - 响应状态码：200
> - 响应数据：
>
> ```json
> {
>     "id": 1,
>     "info": {
>         "results": [
>             {
>                 "all": 2,
>                 "success": 2,
>                 "fail": 0,
>                 "error": 0,
>                 "cases": [
>                     {
>                         "name": "登录成功",
>                         "log_data": [
>                             [
>                                 "INFO",
>                                 "【INFO】  |   开始执行用例：【登录成功】\n"
>                             ],
>                             [
>                                 "INFO",
>                                 "【INFO】  |   *********执行前置脚本*********"
>                             ],
>                             [
>                                 "INFO",
>                                 "【INFO】  |   发送[POST]请求 : 请求地址为http://127.0.0.1:8080/users/login/："
>                             ],
>                             [
>                                 "INFO",
>                                 "【INFO】  |   请求响应状态码:400"
>                             ],
>                             [
>                                 "INFO",
>                                 "【INFO】  |   *********执行后置脚本*********"
>                             ],
>                             [
>                                 "INFO",
>                                 "【INFO】  |   登录成功执行——>【通过】\n"
>                             ]
>                         ],
>                         "url": "http://127.0.0.1:8080/users/login/",
>                         "method": "POST",
>                         "status_cede": 400,
>                         "response_header": {
>                             "Date": "Fri, 22 Jul 2022 08:44:14 GMT",
>                             "Server": "WSGIServer/0.2 CPython/3.8.5",
>                             "Content-Type": "application/json",
>                             "Vary": "Accept, Origin",
>                             "Allow": "POST, OPTIONS",
>                             "X-Frame-Options": "DENY",
>                             "Content-Length": "81",
>                             "X-Content-Type-Options": "nosniff",
>                             "Referrer-Policy": "same-origin"
>                         },
>                         "requests_header": {
>                             "User-Agent": "python-requests/2.28.1",
>                             "Accept-Encoding": "gzip, deflate",
>                             "Accept": "*/*",
>                             "Connection": "keep-alive",
>                             "customer-header": "wahaha",
>                             "Content-Type": "multipart/form-data; boundary=2e4b7864ba2a4e2d815f9cf16105272b",
>                             "Content-Length": "2215"
>                         },
>                         "response_body": "{\n  \"username\": [\n    \"该字段是必填项。\"\n  ],\n  \"password\": [\n    \"该字段是必填项。\"\n  ]\n}",
>                         "requests_body": "<MultipartEncoder: [['file', ('blue_bill.sql', <_io.BufferedReader name='D:\\\\project\\\\backend\\\\upload_files\\\\blue_bill.sql'>, 'application/octet-stream')]]>",
>                         "state": "成功",
>                         "run_time": "0.01s"
>                     },
>                     {
>                         "name": "登录失败",
>                         "log_data": [
>                             [
>                                 "INFO",
>                                 "【INFO】  |   开始执行用例：【登录失败】\n"
>                             ],
>                             [
>                                 "INFO",
>                                 "【INFO】  |   *********执行前置脚本*********"
>                             ],
>                             [
>                                 "INFO",
>                                 "【INFO】  |   发送[POST]请求 : 请求地址为http://127.0.0.1:8080/users/login/："
>                             ],
>                             [
>                                 "INFO",
>                                 "【INFO】  |   请求响应状态码:401"
>                             ],
>                             [
>                                 "INFO",
>                                 "【INFO】  |   *********执行后置脚本*********"
>                             ],
>                             [
>                                 "INFO",
>                                 "【INFO】  |   登录失败执行——>【通过】\n"
>                             ]
>                         ],
>                         "url": "http://127.0.0.1:8080/users/login/",
>                         "method": "POST",
>                         "status_cede": 401,
>                         "response_header": {
>                             "Date": "Fri, 22 Jul 2022 08:44:14 GMT",
>                             "Server": "WSGIServer/0.2 CPython/3.8.5",
>                             "Content-Type": "application/json",
>                             "WWW-Authenticate": "Bearer realm=\"api\"",
>                             "Vary": "Accept, Origin",
>                             "Allow": "POST, OPTIONS",
>                             "X-Frame-Options": "DENY",
>                             "Content-Length": "37",
>                             "X-Content-Type-Options": "nosniff",
>                             "Referrer-Policy": "same-origin"
>                         },
>                         "requests_header": {
>                             "User-Agent": "python-requests/2.28.1",
>                             "Accept-Encoding": "gzip, deflate",
>                             "Accept": "*/*",
>                             "Connection": "keep-alive",
>                             "customer-header": "wahaha",
>                             "Content-Length": "44",
>                             "Content-Type": "application/json"
>                         },
>                         "response_body": "{\n  \"detail\": \"用户名密码错误！\"\n}",
>                         "requests_body": "{\n  \"username\": \"torin\",\n  \"password\": \"123123\"\n}",
>                         "state": "成功",
>                         "run_time": "0.386s"
>                     }
>                 ],
>                 "state": "success",
>                 "name": "登录接口测试"
>             }
>         ],
>         "all": 2,
>         "success": 2,
>         "error": 0,
>         "fail": 0,
>         "task": "1",
>         "test_env": 1,
>         "tester": "torin"
>     },
>     "record": 1
> }
> ```









## 七、定时任务模块接口

#### 1、创建定时任务

> **接口名称：**`/api/crontab/cronjob/`
>
> **请求方式：**POST
>
> **参数格式：**JSON
>
> **请求参数：**
>
> | 变量名  | 类型   | 说明                                        | 是否必传 |
> | ------- | ------ | ------------------------------------------- | -------- |
> | project | 整数   | 所属项目id                                  | 是       |
> | name    | 字符串 | 定时任务名称                                | 是       |
> | task    | 整数   | 被执行测试任务的id                          | 是       |
> | rule    | 字符串 | crontab定时计划                             | 是       |
> | env     | 整数   | 测试环境id                                  | 是       |
> | status  | 整数   | 创建的定时任务的状态，默认为False表示不启动 | 否       |
>
> **请求示例：**
>
> - json格式参数
>
> ```json
> {
>     "project": 1,
>     "name": "冒烟测试定期执行",
>     "rule": "30 20 * * *",
>     "status": true,
>     "task": 1,
>     "env": 1
> }
> ```
>
> **返回示例**
>
> - 响应状态码：201
> - 响应数据：
>
> ```json
> {
>     "id": 8,
>     "task_name": "回归测试",
>     "env_name": "本地",
>     "create_time": "2022-07-25T14:47:03.774080+08:00",
>     "name": "冒烟测试定期执行",
>     "rule": "30 20 * * *",
>     "status": true,
>     "tester": "torin",
>     "project": 1,
>     "task": 1,
>     "env": 1
> }
> 
> ```

#### 2、删除定时任务

> **接口名称：**`/api/crontab/cronjob/${id}/`
>
> **请求方式：**DELETE
>
> **参数格式：**路径参数
>
> **请求参数：** 无
>
> **返回示例**
>
> - 响应状态码：204
> - 响应数据：无

#### 3、修改定时任务

> **接口名称：**`/api/crontab/cronjob/${id}/`
>
> **请求方式：**PATCH
>
> **参数格式：**JSON
>
> **请求参数：**
>
> | 变量名  | 类型   | 说明                                        | 是否必传 |
> | ------- | ------ | ------------------------------------------- | -------- |
> | project | 整数   | 所属项目id                                  | 否       |
> | name    | 字符串 | 定时任务名称                                | 否       |
> | task    | 整数   | 被执行测试任务的id                          | 否       |
> | rule    | 字符串 | crontab定时计划                             | 否       |
> | env     | 整数   | 测试环境id                                  | 否       |
> | status  | 整数   | 创建的定时任务的状态，默认为False表示不启动 | 否       |
>
> **请求示例：**
>
> - json格式参数
>
> ```json
> {
>     "project": 1,
>     "name": "冒烟测试定期执行",
>     "rule": "30 20 * * *",
>     "status": true,
>     "task": 1,
>     "env": 1
> }
> ```
>
> **返回示例**
>
> - 响应状态码：200
> - 响应数据：
>
> ```json
> {
>     "id": 8,
>     "task_name": "回归测试",
>     "env_name": "本地",
>     "create_time": "2022-07-25T14:47:03.774080+08:00",
>     "name": "冒烟测试定期执行",
>     "rule": "30 20 * * *",
>     "status": true,
>     "tester": "torin",
>     "project": 1,
>     "task": 1,
>     "env": 1
> }
> ```

#### 4、查看定时任务列表

> **接口名称：**`/api/crontab/cronjob/`
>
> **请求方式：**GET
>
> **参数格式：**无
>
> **请求参数：**        
>
> | 变量名  | 类型 | 说明       | 是否必传 |
> | ------- | ---- | ---------- | -------- |
> | project | 整数 | 所属项目id | 否       |
> | task    | 整数 | 所属计划id | 否       |
>
> **返回示例**
>
> - 响应状态码：200
> - 响应数据：
>
> ```json
> [
>     {
>         "id": 6,
>         "task_name": "回归测试",
>         "env_name": "本地",
>         "create_time": "2022-07-25T14:38:44.153378+08:00",
>         "name": "冒烟测试定期执行",
>         "rule": "30 14 * * *",
>         "status": true,
>         "tester": "torin",
>         "project": 1,
>         "task": 1,
>         "env": 1
>     },
>     {
>         "id": 8,
>         "task_name": "回归测试",
>         "env_name": "本地",
>         "create_time": "2022-07-25T14:47:03.774080+08:00",
>         "name": "冒烟测试定期执行",
>         "rule": "30 20 * * *",
>         "status": true,
>         "tester": "torin",
>         "project": 1,
>         "task": 1,
>         "env": 1
>     }
> ]
> ```



## 八、bug管理模块接口

#### 1、提交bug

> **接口名称：**`/api/bug/bugs/`
>
> **请求方式：**POST
>
> **参数格式：**JSON
>
> **请求参数：**
>
> | 变量名      | 类型   | 说明              | 是否必传 |
> | :---------- | ------ | :---------------- | -------- |
> | `interface` | 整数   | 接口id            | 是       |
> | `desc`      | 字符串 | bug的说明         | 是       |
> | `info`      | json   | 接口bug的详细信息 | 是       |
> | `status`    | 字符串 | bug的处理状态     | 是       |
> | `user`      | 字符串 | bug的提交者       | 是       |
>
> **请求示例：**
>
> - json格式参数
>
> ```json
> {
>         "id": 1,
>         "desc": "演示的数据",
>         "info": {},
>         "status": "未处理",
>         "user": "torin",
>         "interface": 1
>     }
> ```
>
> **返回示例**
>
> - 响应状态码：201
>
> - 响应数据：
>
>   ```python
>   {
>       "id": 2,
>       "create_time": "2023-09-11T17:24:21.942450+08:00",
>       "desc": "演示的数据",
>       "info": {},
>       "status": "未处理",
>       "user": "torin",
>       "interface": 1
>   }
>   ```
>
>   

#### 2、获取bug列表

> **接口名称：**`/api/bug/bugs/`
>
> **请求方式：**GET
>
> **参数格式：**url参数
>
> **请求参数：**        
>
> | 变量名    | 类型 | 说明   | 是否必传 |
> | --------- | ---- | ------ | -------- |
> | project   | 整数 | 项目id | 是       |
> | interface | 整数 | 接口id | 是       |
>
> **返回示例**
>
> - 响应状态码：200
>
> - 响应数据
>
>   ```python
>   [
>       {
>           "id": 2,
>           "create_time": "2023-09-11T17:24:21.942450+08:00",
>           "desc": "演示的数据",
>           "status": "未处理",
>           "user": "torin",
>           "interface": 1,
>           "interface_url":"/user/login"
>       }
>   ]
>   ```
>
>   

#### 3、查看bug详情

> **接口名称：**`/api/bug/bugs/${id}/`
>
> **请求方式：**GET
>
> **参数格式：**路径参数
>
> **请求参数：**无
>
> **返回示例**
>
> - 响应状态码：200
>
> - 响应数据：
>
>   ```python
>    {
>           "id": 2,
>           "create_time": "2023-09-11T17:24:21.942450+08:00",
>           "desc": "演示的数据",
>           "info": {},
>           "status": "未处理",
>           "user": "torin",
>           "interface": 1,
>           "interface_url":"/user/login"
>           "handle":[
>           	{
>           	"handle":"",
>           	"update_user":"admin"
>           	"create_time":"2023-09-11T17:24:21.942450+08:00",
>           	}
>           ]
>       }
>   ```
>
>   

#### 4、修改bug状态

> **接口名称：**`/api/bug/bugs/${id}/`
>
> **请求方式：**PATCH
>
> **参数格式：**JSON
>
> **请求参数：**
>
> | 变量名   | 类型   | 说明          | 是否必传    |
> | -------- | ------ | ------------- | ----------- |
> | `status` | 字符串 | bug的处理状态 | put请求必传 |
>
> **请求示例：**
>
> - json格式参数
>
> ```json
>  {
>         "id": 2,
>         "create_time": "2023-09-11T17:24:21.942450+08:00",
>         "desc": "演示的数据",
>         "status": "未处理",
>         "user": "torin",
>         "interface": 1,
>         "interface_url":"/user/login"
>     }
> ```
>
> **返回示例**
>
> - 响应状态码：200
> - 响应数据：